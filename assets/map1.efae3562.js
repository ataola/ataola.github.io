import{L as Q,q as X,d as Y,B as H,i as K,K as be,N as c,o as ee,c as he,b as V,O as U,u as f,P as ve,F as qe,Q as Me,E as r,g as ke,p as Se}from"./index.c66ee764.js";function Ce(o){return{all:o=o||new Map,on:function(a,l){var e=o.get(a);e?e.push(l):o.set(a,[l])},off:function(a,l){var e=o.get(a);e&&(l?e.splice(e.indexOf(l)>>>0,1):o.set(a,[]))},emit:function(a,l){var e=o.get(a);e&&e.slice().map(function(i){i(l)}),(e=o.get("*"))&&e.slice().map(function(i){i(a,l)})}}}const w=Ce();function Te(){return{emit:w.emit,on:w.on,off:w.off}}function we(){const{uid:o,emit:a}=X(),{on:l,emit:e,off:i}=Te(),t=`__initd__${o}`;return l(t,s=>{a("initd",s)}),Q(()=>{a("unload"),i(t)}),{ready:(s,u)=>{e(t,{map:s,instance:u,BMapGL:window.BMapGL})}}}const Z={};function m({key:o,src:a,addCalToWindow:l}){return Z[o]||(Z[o]=new Promise((e,i)=>{const t=document.createElement("script"),s=()=>{e(),window.document.body.removeChild(t)};l?window[o]=s:t.onload=function(){(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")&&(t.onload=null,s())},t.src=a,t.type="text/javascript",t.defer=!0,t.onerror=i,document.body.appendChild(t)})),Z[o]}const b={TrackAnimation:"//mapopen.bj.bcebos.com/github/BMapGLLib/TrackAnimation/src/TrackAnimation.min.js",Mapvgl:"https://code.bdstatic.com/npm/mapvgl@1.0.0-beta.159/dist/mapvgl.min.js",Mapv:"https://mapv.baidu.com/build/mapv.min.js",MapvThree:"https://unpkg.com/mapv-three@1.0.1/dist/mapvthree.umd.js"},Ze={TrackAnimation:o=>m({src:o||b.TrackAnimation,addCalToWindow:!1,key:"trackAnimation"}),Mapvgl:o=>m({src:o||b.Mapvgl,addCalToWindow:!1,key:"Mapvgl"}),Mapv:o=>m({src:o||b.Mapv,addCalToWindow:!1,key:"Mapv"}),MapvThree:o=>m({src:o||b.MapvThree,addCalToWindow:!1,key:"MapvThree"})};function Oe(o,a={}){const l=[...new Set(o)].reduce((e,i)=>{let t;return typeof i=="string"&&(t=Ze[i])?e.push(t(a[i])):typeof i=="function"&&e.push(i()),e},[]);return Promise.all(l)}function Be(o,a,l){for(const e of Object.keys(o))if(/^on/.test(e)&&o[e]){const i=e.replace(/^on/,"").toLocaleLowerCase();l.addEventListener(i,t=>{var s,u;t.preventDefault=t.preventDefault||((s=t.domEvent)===null||s===void 0?void 0:s.preventDefault.bind(t.domEvent)),t.stopPropagation=t.stopPropagation||((u=t.domEvent)===null||u===void 0?void 0:u.stopPropagation.bind(t.domEvent)),a(i,t)})}}function O(o){return(a,l)=>{(a===l||a!==l&&JSON.stringify(a)!==JSON.stringify(l))&&o(a)}}function B(o){console.error(`[Vue3 BaiduMap GL] ${o}`)}function F(o){return Object.prototype.toString.call(o)==="[object String]"}const De={style:{color:"#999",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},Ae={name:"BMap"};var te=Y(Object.assign(Object.assign({},Ae),{props:{ak:{type:String,required:!1},width:{type:[String,Number],required:!1,default:"100%"},height:{type:[String,Number],required:!1,default:"550px"},center:{type:[String,Object],required:!1,default:()=>({lat:39.915185,lng:116.403901})},mapType:{type:null,required:!1,default:"BMAP_NORMAL_MAP"},zoom:{type:Number,required:!1,default:14},heading:{type:Number,required:!1,default:0},tilt:{type:Number,required:!1,default:0},minZoom:{type:Number,required:!1,default:0},maxZoom:{type:Number,required:!1,default:21},noAnimation:{type:Boolean,required:!1,default:!1},mapStyleId:{type:String,required:!1},mapStyleJson:{type:Array,required:!1},showControls:{type:Boolean,required:!1,default:!1},plugins:{type:null,required:!1},pluginsSourceLink:{type:Object,required:!1},displayOptions:{type:Object,required:!1},restrictCenter:{type:Boolean,required:!1,default:!0},enableTraffic:{type:Boolean,required:!1,default:!1},enableDragging:{type:Boolean,required:!1,default:!0},enableInertialDragging:{type:Boolean,required:!1,default:!0},enableScrollWheelZoom:{type:Boolean,required:!1,default:!1},enableContinuousZoom:{type:Boolean,required:!1,default:!0},enableResizeOnCenter:{type:Boolean,required:!1,default:!0},enableDoubleClickZoom:{type:Boolean,required:!1,default:!1},enableKeyboard:{type:Boolean,required:!1,default:!0},enablePinchToZoom:{type:Boolean,required:!1,default:!0},enableAutoResize:{type:Boolean,required:!1,default:!0},onClick:{type:null,required:!1},onDblclick:{type:null,required:!1},onRightclick:{type:null,required:!1},onRightdblclick:{type:null,required:!1},onMaptypechange:{type:null,required:!1},onMousemove:{type:null,required:!1},onMouseover:{type:null,required:!1},onMouseout:{type:null,required:!1},onMovestart:{type:null,required:!1},onMoving:{type:null,required:!1},onMoveend:{type:null,required:!1},onZoomstart:{type:null,required:!1},onZoomend:{type:null,required:!1},onAddoverlay:{type:null,required:!1},onAddcontrol:{type:null,required:!1},onRemovecontrol:{type:null,required:!1},onRemoveoverlay:{type:null,required:!1},onClearoverlays:{type:null,required:!1},onDragstart:{type:null,required:!1},onDragging:{type:null,required:!1},onDragend:{type:null,required:!1},onAddtilelayer:{type:null,required:!1},onRemovetilelayer:{type:null,required:!1},onLoad:{type:null,required:!1},onResize:{type:null,required:!1},onHotspotclick:{type:null,required:!1},onHotspotover:{type:null,required:!1},onHotspotout:{type:null,required:!1},onTilesloaded:{type:null,required:!1},onTouchstart:{type:null,required:!1},onTouchmove:{type:null,required:!1},onTouchend:{type:null,required:!1},onLongpress:{type:null,required:!1}},emits:["initd","unload","pluginReady","click","dblclick","rightclick","rightdblclick","maptypechange","mousemove","mouseover","mouseout","movestart","moving","moveend","zoomstart","zoomend","addoverlay","addcontrol","removecontrol","removeoverlay","clearoverlays","dragstart","dragging","dragend","addtilelayer","removetilelayer","load","resize","hotspotclick","hotspotover","hotspotout","tilesloaded","touchstart","touchmove","touchend","longpress"],setup(o,{expose:a,emit:l}){const e=o,i=H();let t=null,s=H(!1);const{ready:u}=we(),{uid:ne,proxy:d}=X(),oe=K(()=>F(e.width)?e.width:`${e.width}px`),ae=K(()=>F(e.height)?e.height:`${e.height}px`),h=e.ak||d.$baiduMapAk,D=e.plugins&&d.$baiduMapPlugins?Object.assign(d.$baiduMapPlugins,e.plugins):e.plugins||d.$baiduMapPlugins,le=e.pluginsSourceLink&&d.$baiduMapPluginsSourceLink?Object.assign(d.$baiduMapPluginsSourceLink,e.pluginsSourceLink):e.pluginsSourceLink||d.$baiduMapPluginsSourceLink||{};h||B("missing required props: ak");const A=`_initBMap${h}`;function ie(){m({src:`//api.map.baidu.com/api?type=webgl&v=1.0&ak=${h}&callback=${A}`,addCalToWindow:!0,key:A}).then(()=>{const{restrictCenter:n,minZoom:p,maxZoom:q,mapType:M,enableAutoResize:k,showControls:S,center:C}=e;!i.value||(t=new BMapGL.Map(i.value,{restrictCenter:n,minZoom:p,maxZoom:q,mapType:window[M],enableAutoResize:k,showControls:S}),g(C),se(),v(),re(),Be(e,l,t),s.value||(s.value=!0,Me(()=>u(t,t)),D&&Oe(D,le).then(()=>{l("pluginReady",t)}).catch(T=>{B("plugins load error: "+T)})))}).catch(B)}function v(){if(e.mapStyleId){t.setMapStyleV2({styleId:e.mapStyleId});return}else e.mapStyleJson&&t.setMapStyleV2({styleJson:e.mapStyleJson})}function re(){r(()=>e.zoom,P),r(()=>e.tilt,j),r(()=>e.heading,R),r(()=>e.center,O(g),{deep:!0}),r(()=>e.mapStyleId,v),r(()=>e.mapStyleJson,O(v),{deep:!0}),r(()=>e.displayOptions,O(_),{deep:!0}),r(()=>e.mapType,z),r(()=>e.enableTraffic,L),r(()=>e.enableDragging,y),r(()=>e.enableInertialDragging,I),r(()=>e.enableScrollWheelZoom,$),r(()=>e.enableContinuousZoom,N),r(()=>e.enableResizeOnCenter,W),r(()=>e.enableDoubleClickZoom,x),r(()=>e.enableKeyboard,E),r(()=>e.enablePinchToZoom,G),r(()=>e.enableAutoResize,J)}function se(){const{enableDragging:n,enableInertialDragging:p,enableScrollWheelZoom:q,enableContinuousZoom:M,enableResizeOnCenter:k,enableDoubleClickZoom:S,enableKeyboard:C,enablePinchToZoom:T,enableAutoResize:de,enableTraffic:pe,displayOptions:ce,mapType:fe,zoom:me,tilt:ge,heading:ye}=e;P(me),j(ge),L(pe),R(ye),z(fe),E(C),y(n),J(de),G(T),N(M),W(k),x(S),$(q),I(p),_(ce)}function ue(n,p){return new BMapGL.Point(n,p)}function L(n){n?t.setTrafficOn():t.setTrafficOff()}function g(n){typeof n=="string"?t.centerAndZoom(n,e.zoom):t.centerAndZoom(ue(n.lng,n.lat),e.zoom)}function _(n){t.setDisplayOptions(n||{})}function P(n){t.setZoom(n,{noAnimation:e.noAnimation})}function z(n){window[n]!==void 0&&t.setMapType(window[n])}function R(n){t.setHeading(n)}function j(n){t.setTilt(n)}function y(n){n?t.enableDragging():t.disableDragging()}function I(n){n?t.enableInertialDragging():t.disableInertialDragging()}function $(n){n?t.enableScrollWheelZoom():t.disableScrollWheelZoom()}function N(n){n?t.enableContinuousZoom():t.disableContinuousZoom()}function W(n){n?t.enableResizeOnCenter():t.disableResizeOnCenter()}function x(n){n?t.enableDoubleClickZoom():t.disableDoubleClickZoom()}function E(n){n?t.enableKeyboard():t.disableKeyboard()}function G(n){n?t.enablePinchToZoom():t.disablePinchToZoom()}function J(n){n?t.enableAutoResize():t.disableAutoResize()}return be(ie),Q(()=>{t==null||t.destroy()}),a({getMapInstance:()=>t,getBaseMapOptions:()=>e,resetCenter:()=>g(e.center),setDragging:y}),c("getMapInstance",()=>t),c("parentUidGetter",ne),c("baseMapSetCenterAndZoom",n=>g(n)),c("baseMapSetDragging",n=>y(n)),c("getBaseMapOptions",()=>e),(n,p)=>(ee(),he(qe,null,[V("div",{class:"baidu-map-container",ref_key:"mapContainer",ref:i,style:ve([{width:f(oe),height:f(ae)},{background:"#f1f1f1",position:"relative",overflow:"hidden"}])},[U(n.$slots,"loading",{isLoading:!f(s)},()=>[V("div",De,ke(f(s)?"":"map loading..."),1)])],4),U(n.$slots,"default")],64))}}));te.__file="packages/components/map/index.vue";const _e=Y({__name:"map1",setup(o){return(a,l)=>(ee(),Se(f(te),{ak:"cwHsf5i2fAQAlijOyELx5COtkFhItaSm",height:"100vh","enable-scroll-wheel-zoom":!0}))}});export{_e as default};
